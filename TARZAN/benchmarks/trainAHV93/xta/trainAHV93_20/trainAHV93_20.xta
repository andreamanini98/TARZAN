const int N = 8;

const int a = 2;
const int b = 5;
const int c = 1;
const int d = 2;
const int e = 1;

int cnt;

chan texit;
chan lower;
chan raise;
chan approach;

process Train01() {
    clock x;
state
    train0,
    train1 { x <= b },
    train2 { x <= b },
    train3 { x <= b };
init
    train0;
trans
    train2 -> train3 { },
    train3 -> train0 { guard x <= b; sync texit?; },
    train1 -> train2 { guard x > a; },
    train0 -> train1 { sync approach?; assign x = 0; };
}

process Train02() {
    clock x;
state
    train0,
    train1 { x <= b },
    train2 { x <= b },
    train3 { x <= b };
init
    train0;
trans
    train2 -> train3 { },
    train3 -> train0 { guard x <= b; sync texit?; },
    train1 -> train2 { guard x > a; },
    train0 -> train1 { sync approach?; assign x = 0; };
}

process Train03() {
    clock x;
state
    train0,
    train1 { x <= b },
    train2 { x <= b },
    train3 { x <= b };
init
    train0;
trans
    train2 -> train3 { },
    train3 -> train0 { guard x <= b; sync texit?; },
    train1 -> train2 { guard x > a; },
    train0 -> train1 { sync approach?; assign x = 0; };
}

process Train04() {
    clock x;
state
    train0,
    train1 { x <= b },
    train2 { x <= b },
    train3 { x <= b };
init
    train0;
trans
    train2 -> train3 { },
    train3 -> train0 { guard x <= b; sync texit?; },
    train1 -> train2 { guard x > a; },
    train0 -> train1 { sync approach?; assign x = 0; };
}

process Train05() {
    clock x;
state
    train0,
    train1 { x <= b },
    train2 { x <= b },
    train3 { x <= b };
init
    train0;
trans
    train2 -> train3 { },
    train3 -> train0 { guard x <= b; sync texit?; },
    train1 -> train2 { guard x > a; },
    train0 -> train1 { sync approach?; assign x = 0; };
}

process Train06() {
    clock x;
state
    train0,
    train1 { x <= b },
    train2 { x <= b },
    train3 { x <= b };
init
    train0;
trans
    train2 -> train3 { },
    train3 -> train0 { guard x <= b; sync texit?; },
    train1 -> train2 { guard x > a; },
    train0 -> train1 { sync approach?; assign x = 0; };
}

process Train07() {
    clock x;
state
    train0,
    train1 { x <= b },
    train2 { x <= b },
    train3 { x <= b };
init
    train0;
trans
    train2 -> train3 { },
    train3 -> train0 { guard x <= b; sync texit?; },
    train1 -> train2 { guard x > a; },
    train0 -> train1 { sync approach?; assign x = 0; };
}

process Train08() {
    clock x;
state
    train0,
    train1 { x <= b },
    train2 { x <= b },
    train3 { x <= b };
init
    train0;
trans
    train2 -> train3 { },
    train3 -> train0 { guard x <= b; sync texit?; },
    train1 -> train2 { guard x > a; },
    train0 -> train1 { sync approach?; assign x = 0; };
}

process Train09() {
    clock x;
state
    train0,
    train1 { x <= b },
    train2 { x <= b },
    train3 { x <= b };
init
    train0;
trans
    train2 -> train3 { },
    train3 -> train0 { guard x <= b; sync texit?; },
    train1 -> train2 { guard x > a; },
    train0 -> train1 { sync approach?; assign x = 0; };
}

process Train10() {
    clock x;
state
    train0,
    train1 { x <= b },
    train2 { x <= b },
    train3 { x <= b };
init
    train0;
trans
    train2 -> train3 { },
    train3 -> train0 { guard x <= b; sync texit?; },
    train1 -> train2 { guard x > a; },
    train0 -> train1 { sync approach?; assign x = 0; };
}

process Train11() {
    clock x;
state
    train0,
    train1 { x <= b },
    train2 { x <= b },
    train3 { x <= b };
init
    train0;
trans
    train2 -> train3 { },
    train3 -> train0 { guard x <= b; sync texit?; },
    train1 -> train2 { guard x > a; },
    train0 -> train1 { sync approach?; assign x = 0; };
}

process Train12() {
    clock x;
state
    train0,
    train1 { x <= b },
    train2 { x <= b },
    train3 { x <= b };
init
    train0;
trans
    train2 -> train3 { },
    train3 -> train0 { guard x <= b; sync texit?; },
    train1 -> train2 { guard x > a; },
    train0 -> train1 { sync approach?; assign x = 0; };
}

process Train13() {
    clock x;
state
    train0,
    train1 { x <= b },
    train2 { x <= b },
    train3 { x <= b };
init
    train0;
trans
    train2 -> train3 { },
    train3 -> train0 { guard x <= b; sync texit?; },
    train1 -> train2 { guard x > a; },
    train0 -> train1 { sync approach?; assign x = 0; };
}

process Train14() {
    clock x;
state
    train0,
    train1 { x <= b },
    train2 { x <= b },
    train3 { x <= b };
init
    train0;
trans
    train2 -> train3 { },
    train3 -> train0 { guard x <= b; sync texit?; },
    train1 -> train2 { guard x > a; },
    train0 -> train1 { sync approach?; assign x = 0; };
}

process Train15() {
    clock x;
state
    train0,
    train1 { x <= b },
    train2 { x <= b },
    train3 { x <= b };
init
    train0;
trans
    train2 -> train3 { },
    train3 -> train0 { guard x <= b; sync texit?; },
    train1 -> train2 { guard x > a; },
    train0 -> train1 { sync approach?; assign x = 0; };
}

process Train16() {
    clock x;
state
    train0,
    train1 { x <= b },
    train2 { x <= b },
    train3 { x <= b };
init
    train0;
trans
    train2 -> train3 { },
    train3 -> train0 { guard x <= b; sync texit?; },
    train1 -> train2 { guard x > a; },
    train0 -> train1 { sync approach?; assign x = 0; };
}

process Train17() {
    clock x;
state
    train0,
    train1 { x <= b },
    train2 { x <= b },
    train3 { x <= b };
init
    train0;
trans
    train2 -> train3 { },
    train3 -> train0 { guard x <= b; sync texit?; },
    train1 -> train2 { guard x > a; },
    train0 -> train1 { sync approach?; assign x = 0; };
}

process Train18() {
    clock x;
state
    train0,
    train1 { x <= b },
    train2 { x <= b },
    train3 { x <= b };
init
    train0;
trans
    train2 -> train3 { },
    train3 -> train0 { guard x <= b; sync texit?; },
    train1 -> train2 { guard x > a; },
    train0 -> train1 { sync approach?; assign x = 0; };
}

process Train19() {
    clock x;
state
    train0,
    train1 { x <= b },
    train2 { x <= b },
    train3 { x <= b };
init
    train0;
trans
    train2 -> train3 { },
    train3 -> train0 { guard x <= b; sync texit?; },
    train1 -> train2 { guard x > a; },
    train0 -> train1 { sync approach?; assign x = 0; };
}

process Train20() {
    clock x;
state
    train0,
    train1 { x <= b },
    train2 { x <= b },
    train3 { x <= b };
init
    train0;
trans
    train2 -> train3 { },
    train3 -> train0 { guard x <= b; sync texit?; },
    train1 -> train2 { guard x > a; },
    train0 -> train1 { sync approach?; assign x = 0; };
}

process gate() {
    clock y;
state
    gate0,
    gate1 { y <= c },
    gate2,
    gate3 { y <= d };
init
    gate0;
trans
    gate1 -> gate2 { guard y <= c; },
    gate2 -> gate3 { sync raise?; assign y = 0; },
    gate0 -> gate1 { sync lower?; assign y = 0; },
    gate3 -> gate0 { guard y >= c && y <= d; };
}

process controller() {
    clock z;
state
    controller0,
    controller1 { z <= e },
    controller2,
    controller3 { z <= e };
init
    controller0;
trans
    controller0 -> controller1 { sync approach!; assign z = 0, cnt = 1; },
    controller1 -> controller1 { sync approach!; assign cnt = cnt + 1; },
    controller1 -> controller1 { sync texit!; assign cnt = cnt - 1; },
    controller2 -> controller2 { sync approach!; assign cnt = cnt + 1; },
    controller2 -> controller2 { guard cnt > 1; sync texit!; assign cnt = cnt - 1; },
    controller2 -> controller3 { guard cnt == 1; sync texit!; assign z = 0, cnt = 0; },
    controller3 -> controller0 { guard z <= e; sync raise!; },
    controller3 -> controller2 { guard z <= e; sync approach!; assign cnt = cnt + 1; },
    controller1 -> controller2 { guard z == e; sync lower!; };
}

system Train01, Train02, Train03, Train04, Train05, Train06, Train07, Train08, Train09, Train10, Train11, Train12, Train13, Train14, Train15, Train16, Train17, Train18, Train19, Train20, gate, controller;
